.right
  = link_to 'Previous item', @item.prev_item, :class => 'button' if @item.prev_item

  - if can? :update, @item
    = link_to 'Edit item', edit_item_path(@item), :class => 'button'

  - if @item.next_item
    = link_to 'Next item', @item.next_item, :class => 'button'
  - else
    = link_to 'Next item', @item.next_item, :class => 'button invisible'

.clear{:style => "padding-top: 7px"}

.twoup-1
  %fieldset
    %legend Item details
    - if can? :manage, @item
      .right
        = check_box_tag :private, @item.private, @item.private, :disabled => true
        Private

    %table.form.show
      %tr
        %th Item ID
        %td
          .left
            %span= @item.full_identifier
          .right<
            = link_to '(Collection Details)', @item.collection

      %tr
        %th Title
        %td= @item.title

      %tr
        %th Description
        %td= @item.description

      %tr
        %th Origination date
        %td= @item.originated_on

      %tr
        %th Origination date free form
        %td= @item.originated_on_narrative

      %tr
        %th Archive link
        %td= item_archive_url(@item)

      %tr
        %th URL
        %td= @item.url

      %tr
        %th Collector
        %td= @item.collector_name

      %tr
        %th Countries
        %td
          - @item.countries.each do |country|
            = country.name_with_code
            %br

      %tr
        %th Language as given
        %td= @item.language

      %tr
        %th Subject language(s)
        %td
          - @item.subject_languages.each do |language|
            = language.name_with_code
            %br

      %tr
        %th Content language(s)
        %td
          - @item.content_languages.each do |language|
            = language.name_with_code
            %br

      %tr
        %th Dialect
        %td= @item.dialect

      %tr
        %th Region / village
        %td= @item.region

      %tr
        %th Latitude
        %td= @item.latitude

      %tr
        %th Longitude
        %td= @item.longitude

      %tr
        %th Zoom
        %td= @item.zoom

      %tr
        %td.empty{:colspan => 2}
          .map{:data => {:latitude => @item.latitude, :longitude => @item.longitude, :zoom => @item.zoom, :static => true}}

      %tr
        %th Originating university
        %td= @item.university_name

      %tr
        %th Operator
        %td= @item.operator_name

      %tr
        %th Discourse type
        %td= @item.discourse_type_name

      %tr
        %th Roles
        %td
          - @item.item_agents.each do |item_agent|
            == #{item_agent.user.name} : #{item_agent.agent_role.name}
            %br
      %tr
        %th Cite as
        %td= @item.citation.html_safe

.twoup-2
  .tabs
    %ul
      %li.tab= link_to "Content Files (#{@num_files})", '#content_item'
      %li.tab= link_to 'Collection Information', '#collection'

    #content_item
      = render :partial => 'essences'

    #collection
      %table.form.show
        %tr
          %th Collection title
          %td= @item.collection.title

        %tr
          %th Collection ID
          %td= @item.collection.identifier

        %tr
          %th Description
          %td= @item.collection.description

        %tr
          %th Countries
          %td
            - @item.collection.countries.each do |country|
              = country.name
              %br

        %tr
          %th Languages
          %td
            - @item.collection.languages.each do |language|
              = language.name
              %br

        %tr
          %th Latitude
          %td= @item.collection.latitude

        %tr
          %th Longitude
          %td= @item.collection.longitude

        %tr
          %th Zoom
          %td= @item.collection.zoom

        %tr
          %td.empty{:colspan => 2}
            .map{:data => {:latitude => @item.collection.latitude, :longitude => @item.collection.longitude, :zoom => @item.collection.zoom, :static => true}}


  .tabs
    %ul
      %li.tab= link_to 'Comments', '#comment'
      - if can? :manage, @item
        %li.tab= link_to 'Archive information', '#archive'
        %li.tab= link_to 'Admin information', '#admin'

    #comment
      = render :partial => 'comments/new', :locals => { :item => @item }
      = render :partial => 'comments/comments', :locals => {:comments => @item.comments.approved}

    - if can? :manage, @item
      #archive
        %table.form.show
          %tr
            %td.empty
            %td
              = check_box_tag :checked, @item.metadata_exportable, @item.metadata_exportable, :disabled => true
              Ready for metadata export
          %tr
            %td.empty
            %td
              = check_box_tag :checked, @item.born_digital, @item.born_digital, :disabled => true
              Born digital
          %tr
            %td.empty
            %td
              = check_box_tag :checked, @item.tapes_returned, @item.tapes_returned, :disabled => true
              Tapes returned to depositor
          %tr
            %th Original media
            %td= @item.original_media

          %tr
            %th Data received
            %td= @item.received_on

          %tr
            %th Date digitised
            %td= @item.digitised_on

          %tr
            %th Ingest notes
            %td= @item.ingest_notes

          %tr
            %th Metadata imported
            %td= @item.metadata_imported_on

          %tr
            %th Metadata exported
            %td= @item.metadata_exported_on

          %tr
            %th Tracking
            %td= @item.tracking

    - if can? :manage, @item
      #admin
        %table.form.show
          %tr
            %th Record created
            %td= @item.created_at.to_date
          %tr
            %th Record modified
            %td= @item.updated_at.to_date

          %tr
            %th Edit access
            %td
              - @item.admins.each do |admin|
                = admin.name
                %br

          %tr
            %th Data access conditions
            %td= @item.access_condition_name

          %tr
            %th Data access narrative
            %td= @item.access_narrative

          %tr
            %th Comments
            %td= @item.admin_comment


  - if can? :update, @item
    .right
      = link_to 'Edit item', edit_item_path(@item), :class => 'button'
